# Starship ~~were meant to flyyyyy~~ prompt configuration
#
# Copyright (c) 2026 Florian "Ori" Neveu
# SPDX-License-Identifier: WTFPL
# https://starship.rs/config/

# Prompt format
format = """
$username\
$hostname\
$directory\
$git_branch\
$git_status\
$nodejs\
${custom.php}\
$python\
$rust\
$golang\
$cmd_duration\
$line_break\
$character"""

# Remove initial newline
add_newline = false

# ------------------------------------------------------------------
# Prompt caracter
# ------------------------------------------------------------------
[character]
success_symbol = "[❯](bold green)"
error_symbol = "[❯](bold red)"

# ------------------------------------------------------------------
# Current directory
# ------------------------------------------------------------------
[directory]
truncation_length = 3
truncate_to_repo = true
format = "[$path]($style)[$read_only]($read_only_style) "
style = "bold cyan"
read_only = " "
read_only_style = "red"
home_symbol = "~"

# ------------------------------------------------------------------
# Git
# ------------------------------------------------------------------
[git_branch]
symbol = " "
format = "on [$symbol$branch]($style) "
style = "bold purple"

[git_status]
format = '([\[$all_status$ahead_behind\]]($style) )'
style = "bold red"
conflicted = "="
ahead = "⇡${count}"
behind = "⇣${count}"
diverged = "⇕⇡${ahead_count}⇣${behind_count}"
untracked = "?"
stashed = "$"
modified = "!"
staged = "+"
renamed = "»"
deleted = "✘"

# ------------------------------------------------------------------
# Langages
# ------------------------------------------------------------------
[nodejs]
symbol = " "
format = "via [$symbol($version )]($style)"
detect_files = ["package.json", ".nvmrc", ".node-version"]
detect_folders = ["node_modules"]
style = "bold green"

[php]
disabled = true

[custom.php]
symbol = " "
command = '''
dir="$PWD"
while [[ "$dir" != "/" ]]; do
  if [[ -f "$dir/composer.json" || -f "$dir/.php-version" ]]; then
    symfony php -v 2>/dev/null | head -1 | awk '{print $2}'
    exit
  fi
  dir="$(dirname "$dir")"
done
'''
format = "via [$symbol($output )]($style)"
style = "bold blue"
when = '''
dir="$PWD"
while [[ "$dir" != "/" ]]; do
  [[ -f "$dir/composer.json" || -f "$dir/.php-version" ]] && exit 0
  dir="$(dirname "$dir")"
done
exit 1
'''

[python]
symbol = " "
format = "via [$symbol($version )]($style)"
detect_files = ["requirements.txt", ".python-version", "pyproject.toml"]
style = "bold yellow"

[rust]
symbol = " "
format = "via [$symbol($version )]($style)"
detect_files = ["Cargo.toml"]
style = "bold red"

[golang]
symbol = " "
format = "via [$symbol($version )]($style)"
detect_files = ["go.mod", "go.sum"]
style = "bold cyan"

# ------------------------------------------------------------------
# Command duration
# ------------------------------------------------------------------
[cmd_duration]
min_time = 2_000
format = "took [$duration]($style) "
style = "bold yellow"

# ------------------------------------------------------------------
# Hostname
# ------------------------------------------------------------------
[hostname]
ssh_only = true
format = "[@$hostname]($style) "
style = "bold green"
disabled = false

# ------------------------------------------------------------------
# Username
# ------------------------------------------------------------------
[username]
show_always = false
format = "[$user]($style) "
style_user = "bold yellow"
style_root = "bold red"
disabled = false
